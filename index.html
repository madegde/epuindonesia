<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPU Indonesia - Economic Policy Uncertainty Index</title>
    <meta name="description" content="Economic Policy Uncertainty Index for Indonesia (1994-2024)">
    
    <!-- Plotly.js from CDN -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: #f8f9fa;
        }

        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 100px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 200%;
            height: 100%;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 50px,
                rgba(255,255,255,0.03) 50px,
                rgba(255,255,255,0.03) 100px
            );
            animation: slide 20s linear infinite;
        }

        @keyframes slide {
            to { left: 100%; }
        }

        .hero h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            font-weight: 700;
            letter-spacing: -1px;
            position: relative;
            z-index: 1;
        }

        .hero .subtitle {
            font-size: 1.3em;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 20px;
        }

        .section {
            background: white;
            padding: 60px;
            border-radius: 15px;
            margin-bottom: 40px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        h2 {
            font-size: 2.2em;
            margin-bottom: 30px;
            color: #2c3e50;
            position: relative;
            padding-bottom: 15px;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .chart-container {
            margin: 40px 0;
            height: 600px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            background: white;
        }

        .control-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-group label {
            font-weight: 500;
            font-size: 0.95em;
        }

        .control-group select,
        .control-group input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .btn {
            padding: 10px 20px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.3s, box-shadow 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: scale(1.05);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.95;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .loading-container {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .method-card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #f0f0f0;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .method-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .method-card h4 {
            color: #3498db;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        footer {
            background: #2c3e50;
            color: white;
            padding: 40px 20px;
            text-align: center;
        }

        footer a {
            color: #667eea;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2em;
            }
            
            .section {
                padding: 30px 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .control-panel {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Hero Section -->
    <div class="hero">
        <h1>EPU Indonesia</h1>
        <p class="subtitle">Economic Policy Uncertainty Index for Indonesia (1994-2024)</p>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Overview Section -->
        <section class="section">
            <h2>Research Overview</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="years-stat">30</div>
                    <div class="stat-label">Years Analyzed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="articles-stat">6,340</div>
                    <div class="stat-label">Articles Processed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="months-stat">362</div>
                    <div class="stat-label">Monthly Data Points</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="epu-stat">98%</div>
                    <div class="stat-label">EPU Matching Rate</div>
                </div>
            </div>

            <p style="font-size: 1.1em; line-height: 1.8; margin-top: 30px;">
                This study constructs the first comprehensive news-based Economic Policy Uncertainty (EPU) index for Indonesia, covering October 1994 to December 2024. Using the Baker, Bloom, and Davis (2016) methodology, we analyze 6,340 articles from five leading Indonesian newspapers to track policy uncertainty over three decades.
            </p>
        </section>

        <!-- Methodology Section -->
        <section class="section">
            <h2>Methodology</h2>
            
            <div class="method-grid">
                <div class="method-card">
                    <h4>Data Collection</h4>
                    <p>Articles from Factiva database covering 5 major Indonesian newspapers over 30+ years</p>
                </div>
                <div class="method-card">
                    <h4>Text Processing</h4>
                    <p>Python-based RTF conversion and keyword matching for E+P+U terms</p>
                </div>
                <div class="method-card">
                    <h4>Index Construction</h4>
                    <p>Baker, Bloom & Davis 5-step standardization and normalization process</p>
                </div>
                <div class="method-card">
                    <h4>Visualization</h4>
                    <p>Interactive Plotly.js charts with event annotations and data filtering</p>
                </div>
            </div>
        </section>

        <!-- Article Coverage Chart -->
        <section class="section">
            <h2>Figure 1: Article Coverage per Publisher Over Time</h2>
            
            <div class="control-panel">
                <div class="control-group">
                    <label>Publisher:</label>
                    <select id="publisher-filter">
                        <option value="all">All Publishers</option>
                        <option value="JKPOST">The Jakarta Post</option>
                        <option value="ANTARA">LKBN ANTARA</option>
                        <option value="BISNIS">Bisnis Indonesia</option>
                        <option value="TEMPOE">Tempo.co</option>
                        <option value="TEMGEN">Tempo Magazine</option>
                        <option value="JGLOBE">Jakarta Globe</option>
                    </select>
                </div>
                <button class="btn" onclick="updateArticleChart()">Update Chart</button>
                <a href="#" class="btn" onclick="downloadData('articles')">Download Data</a>
            </div>
            
            <div class="chart-container">
                <div class="loading-container" id="loading1">
                    <div class="loader"></div>
                    <p>Loading article coverage data...</p>
                </div>
                <div id="article-coverage-chart" style="width:100%;height:100%;"></div>
            </div>
        </section>

        <!-- EPU Index Chart -->
        <section class="section">
            <h2>Figure 2: Economic Policy Uncertainty Index</h2>
            
            <div class="control-panel">
                <div class="control-group">
                    <label>Date Range:</label>
                    <select id="date-filter">
                        <option value="all">Full Period (1994-2024)</option>
                        <option value="1990s">1990s (1990-1999)</option>
                        <option value="2000s">2000s (2000-2009)</option>
                        <option value="2010s">2010s (2010-2019)</option>
                        <option value="2020s">2020s (2020-2024)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>Show Events:</label>
                    <input type="checkbox" id="show-events" checked>
                </div>
                <button class="btn" onclick="updateEPUChart()">Update Chart</button>
                <a href="#" class="btn" onclick="downloadData('epu')">Download Data</a>
            </div>
            
            <div class="chart-container">
                <div class="loading-container" id="loading2">
                    <div class="loader"></div>
                    <p>Loading EPU index data...</p>
                </div>
                <div id="epu-index-chart" style="width:100%;height:100%;"></div>
            </div>
        </section>

        <!-- Key Findings Section -->
        <section class="section">
            <h2>Key Findings</h2>
            <div class="method-grid">
                <div class="method-card">
                    <h4>Peak Uncertainty Periods</h4>
                    <p><strong>1998 Asian Financial Crisis:</strong> EPU peaked at 320<br>
                    <strong>2001 Political Scandals:</strong> Wahid impeachment (255)<br>
                    <strong>2020 COVID-19 Pandemic:</strong> Global health crisis (228)</p>
                </div>
                <div class="method-card">
                    <h4>Global Events Impact</h4>
                    <p><strong>2008 Global Financial Crisis:</strong> Moderate increase<br>
                    <strong>2015 China Economic Turmoil:</strong> Significant spike<br>
                    <strong>2022 Russia-Ukraine War:</strong> Polycrisis effects</p>
                </div>
                <div class="method-card">
                    <h4>Domestic Policy Events</h4>
                    <p><strong>2014 Fuel Subsidy Cuts:</strong> Jokowi's early reforms<br>
                    <strong>2002 Constitutional Amendments:</strong> Democratic transition<br>
                    <strong>2004 Election Year:</strong> First direct presidential election</p>
                </div>
                <div class="method-card">
                    <h4>Research Impact</h4>
                    <p>First comprehensive EPU index for Indonesia providing insights for policymakers, investors, and researchers studying emerging market policy uncertainty dynamics.</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 EPU Indonesia Research | Created by Made Gde</p>
        <p>GitHub: <a href="https://github.com/madegde/epuindonesia">View Source Code</a></p>
        <p>Data: <a href="data/combined_data.json">Access Raw Data</a></p>
    </footer>

    <!-- Load your exported data files -->
    <script src="js/epu_data.js"></script>
    <script src="js/article_data.js"></script> 
    <script src="js/events_data.js"></script>
    <script src="js/stats_data.js"></script>

    <script>
        // Application state
        let currentEPUData = null;
        let currentArticleData = null;

        // Initialize application
        async function initializeApp() {
            try {
                // Try to use loaded data from JS files
                if (typeof epuData !== 'undefined') {
                    currentEPUData = epuData;
                } else {
                    // Fallback: load from JSON
                    const response = await fetch('data/combined_data.json');
                    const data = await response.json();
                    currentEPUData = data.epu_index;
                    window.articleData = data.articles;
                    window.majorEvents = data.events;
                    window.statsData = data.stats;
                }

                if (typeof articleData !== 'undefined') {
                    currentArticleData = articleData;
                }

                // Create charts
                createEPUChart();
                createArticleChart();
                updateStatistics();

            } catch (error) {
                console.log('Loading embedded fallback data...');
                loadFallbackData();
            }
        }

        // Create EPU Index Chart
        function createEPUChart() {
            document.getElementById('loading2').style.display = 'none';
            
            if (!currentEPUData) {
                console.error('No EPU data available');
                return;
            }

            // Filter data based on date range
            const dateFilter = document.getElementById('date-filter').value;
            let filteredData = currentEPUData;
            
            if (dateFilter !== 'all') {
                const ranges = {
                    '1990s': ['1990-01-01', '1999-12-31'],
                    '2000s': ['2000-01-01', '2009-12-31'],
                    '2010s': ['2010-01-01', '2019-12-31'],
                    '2020s': ['2020-01-01', '2030-12-31']
                };
                
                if (ranges[dateFilter]) {
                    filteredData = currentEPUData.filter(d => {
                        const date = new Date(d.Month);
                        return date >= new Date(ranges[dateFilter][0]) && 
                               date <= new Date(ranges[dateFilter][1]);
                    });
                }
            }

            const trace = {
                x: filteredData.map(d => d.Month),
                y: filteredData.map(d => d.EPU_Index),
                type: 'scatter',
                mode: 'lines',
                name: 'EPU Index',
                line: {
                    color: '#667eea',
                    width: 3
                },
                fill: 'tonexty',
                fillcolor: 'rgba(102, 126, 234, 0.1)',
                hovertemplate: '<b>EPU Index</b><br>Date: %{x}<br>Value: %{y:.1f}<extra></extra>'
            };

            const layout = {
                title: {
                    text: 'Economic Policy Uncertainty Index for Indonesia',
                    font: {size: 20, family: 'Arial, sans-serif', color: '#2c3e50'}
                },
                xaxis: {
                    title: 'Year',
                    type: 'date',
                    showgrid: true,
                    gridcolor: '#E5E5E5',
                    tickformat: '%Y'
                },
                yaxis: {
                    title: 'EPU Index',
                    showgrid: true,
                    gridcolor: '#E5E5E5'
                },
                plot_bgcolor: 'white',
                paper_bgcolor: 'white',
                height: 550,
                margin: {l: 80, r: 50, t: 100, b: 80},
                annotations: []
            };

            // Add event annotations if enabled
            if (document.getElementById('show-events').checked && typeof majorEvents !== 'undefined') {
                majorEvents.forEach(event => {
                    const eventDate = new Date(event.date);
                    const rangeStart = new Date(filteredData[0]?.Month);
                    const rangeEnd = new Date(filteredData[filteredData.length - 1]?.Month);
                    
                    if (eventDate >= rangeStart && eventDate <= rangeEnd) {
                        layout.annotations.push({
                            x: event.date,
                            y: event.value,
                            text: event.text,
                            showarrow: true,
                            arrowhead: 2,
                            arrowsize: 1.2,
                            arrowwidth: 2,
                            arrowcolor: '#e74c3c',
                            ax: 0,
                            ay: -60,
                            bgcolor: 'rgba(255,255,255,0.95)',
                            bordercolor: '#e74c3c',
                            borderwidth: 1.5,
                            font: {size: 10, color: '#333', family: 'Arial'}
                        });
                    }
                });
            }

            const config = {
                responsive: true,
                displayModeBar: true,
                modeBarButtonsToRemove: ['pan2d', 'lasso2d', 'select2d'],
                displaylogo: false,
                toImageButtonOptions: {
                    format: 'png',
                    filename: 'epu_indonesia_index',
                    height: 600,
                    width: 1200,
                    scale: 2
                }
            };

            Plotly.newPlot('epu-index-chart', [trace], layout, config);
        }

        // Create Article Coverage Chart
        function createArticleChart() {
            document.getElementById('loading1').style.display = 'none';
            
            if (!currentArticleData) {
                console.error('No article data available');
                return;
            }

            // Filter data based on publisher selection
            const publisherFilter = document.getElementById('publisher-filter').value;
            let filteredData = currentArticleData;
            
            if (publisherFilter !== 'all') {
                filteredData = currentArticleData.filter(d => d.Publisher_Code === publisherFilter);
            }

            // Group by publisher for separate traces
            const publisherGroups = {};
            filteredData.forEach(d => {
                if (!publisherGroups[d.Publisher_Code]) {
                    publisherGroups[d.Publisher_Code] = {
                        dates: [],
                        codes: [],
                        names: [],
                        headlines: []
                    };
                }
                publisherGroups[d.Publisher_Code].dates.push(d.Date);
                publisherGroups[d.Publisher_Code].codes.push(d.Publisher_Code);
                publisherGroups[d.Publisher_Code].names.push(d.Publisher);
                publisherGroups[d.Publisher_Code].headlines.push(d.Headline || 'Article');
            });

            const traces = [];
            const colors = {
                'JKPOST': '#1f77b4',
                'ANTARA': '#ff7f0e', 
                'BISNIS': '#2ca02c',
                'TEMPOE': '#d62728',
                'TEMGEN': '#9467bd',
                'JGLOBE': '#8c564b'
            };

            Object.keys(publisherGroups).forEach(pubCode => {
                const group = publisherGroups[pubCode];
                traces.push({
                    x: group.dates,
                    y: group.codes,
                    mode: 'markers',
                    type: 'scatter',
                    name: group.names[0] || pubCode,
                    marker: {
                        color: colors[pubCode] || '#000000',
                        size: 8,
                        opacity: 0.7,
                    },
                    text: group.headlines,
                    hovertemplate: '<b>%{fullData.name}</b><br>Date: %{x}<br>%{text}<extra></extra>'
                });
            });

            const layout = {
                title: {
                    text: 'Article Coverage per Publisher Over Time',
                    font: {size: 20, family: 'Arial, sans-serif', color: '#2c3e50'}
                },
                xaxis: {
                    title: 'Year',
                    type: 'date',
                    showgrid: true,
                    gridcolor: '#E5E5E5'
                },
                yaxis: {
                    title: 'Publisher',
                    categoryorder: 'array',
                    categoryarray: ['JKPOST', 'ANTARA', 'BISNIS', 'TEMPOE', 'TEMGEN', 'JGLOBE']
                },
                plot_bgcolor: 'white',
                paper_bgcolor: 'white',
                height: 550,
                margin: {l: 120, r: 50, t: 100, b: 80},
                legend: {
                    orientation: 'v',
                    x: 1.02,
                    y: 1
                }
            };

            const config = {
                responsive: true,
                displayModeBar: true,
                modeBarButtonsToRemove: ['pan2d', 'lasso2d', 'select2d'],
                displaylogo: false
            };

            Plotly.newPlot('article-coverage-chart', traces, layout, config);
        }

        // Update functions
        function updateEPUChart() {
            createEPUChart();
        }

        function updateArticleChart() {
            createArticleChart();
        }

        // Update statistics from loaded data
        function updateStatistics() {
            if (typeof statsData !== 'undefined') {
                document.getElementById('articles-stat').textContent = statsData.total_articles.toLocaleString();
                document.getElementById('months-stat').textContent = statsData.months_covered;
                document.getElementById('epu-stat').textContent = statsData.epu_percentage + '%';
            }
        }

        // Download functions
        function downloadData(type) {
            let csvContent = "data:text/csv;charset=utf-8,";
            let filename = "";
            
            if (type === 'epu' && currentEPUData) {
                csvContent += "Date,EPU_Index\n";
                currentEPUData.forEach(row => {
                    csvContent += `${row.Month},${row.EPU_Index}\n`;
                });
                filename = "epu_indonesia_index.csv";
                
            } else if (type === 'articles' && currentArticleData) {
                csvContent += "Date,Publisher,Publisher_Code,Headline\n";
                currentArticleData.forEach(row => {
                    const headline = (row.Headline || '').replace(/"/g, '""'); // Escape quotes
                    csvContent += `${row.Date},"${row.Publisher}",${row.Publisher_Code},"${headline}"\n`;
                });
                filename = "article_coverage_data.csv";
            } else {
                alert('Data not available for download');
                return;
            }
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", filename);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Fallback data (embedded sample from your research)
        function loadFallbackData() {
            console.log('Using fallback data...');
            
            currentEPUData = [
                {Month: '1994-10-01', EPU_Index: 42.23},
                {Month: '1998-06-01', EPU_Index: 319.96}, // Asian Financial Crisis
                {Month: '2001-05-01', EPU_Index: 254.69}, // Wahid Scandal
                {Month: '2008-05-01', EPU_Index: 128.56}, // Global Financial Crisis
                {Month: '2020-09-01', EPU_Index: 227.74}, // COVID-19
                {Month: '2024-11-01', EPU_Index: 186.57}  // US Election 2024
            ];

            currentArticleData = [
                {Date: '1994-10-04', Publisher: 'The Jakarta Post', Publisher_Code: 'JKPOST', Headline: 'TRADE MINISTERS OF APEC TO DISCUSS NEW GATT HERE'},
                {Date: '2000-01-31', Publisher: 'LKBN ANTARA', Publisher_Code: 'ANTARA', Headline: 'Economic policy discussion'},
                {Date: '2011-09-26', Publisher: 'The Jakarta Globe', Publisher_Code: 'JGLOBE', Headline: 'Market uncertainty analysis'}
            ];

            window.majorEvents = [
                {date: '1998-06-01', text: 'Asian Financial Crisis', value: 319.96},
                {date: '2001-05-01', text: 'Wahid Scandal', value: 254.69},
                {date: '2020-09-01', text: 'COVID-19 Pandemic', value: 227.74}
            ];

            createEPUChart();
            createArticleChart();
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', initializeApp);
        document.getElementById('show-events').addEventListener('change', updateEPUChart);
        document.getElementById('date-filter').addEventListener('change', updateEPUChart);
        document.getElementById('publisher-filter').addEventListener('change', updateArticleChart);

        // Handle responsive resizing
        window.addEventListener('resize', function() {
            if (document.getElementById('article-coverage-chart').children.length > 0) {
                Plotly.Plots.resize('article-coverage-chart');
            }
            if (document.getElementById('epu-index-chart').children.length > 0) {
                Plotly.Plots.resize('epu-index-chart');
            }
        });
    </script>
</body>
</html>
