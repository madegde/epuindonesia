<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPU Indonesia - Economic Policy Uncertainty Index</title>
    <meta name="description" content="Economic Policy Uncertainty Index for Indonesia">
    <meta name="author" content="Made Gde">
    
    <!-- D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    <!-- Prism for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-red: #CE1126;
            --primary-white: #FFFFFF;
            --dark-gray: #2c3e50;
            --light-gray: #ecf0f1;
            --accent: #3498db;
            --success: #27ae60;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            color: var(--dark-gray);
            background: #f8f9fa;
        }

        /* Header */
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 100px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 200%;
            height: 100%;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 50px,
                rgba(255,255,255,0.03) 50px,
                rgba(255,255,255,0.03) 100px
            );
            animation: slide 20s linear infinite;
        }

        @keyframes slide {
            to { left: 100%; }
        }

        .hero h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            font-weight: 700;
            letter-spacing: -1px;
            position: relative;
            z-index: 1;
        }

        .hero .subtitle {
            font-size: 1.3em;
            opacity: 0.95;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
        }

        .tech-stack {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .tech-badge {
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            font-weight: 500;
            transition: transform 0.3s, background 0.3s;
        }

        .tech-badge:hover {
            transform: translateY(-3px);
            background: rgba(255,255,255,0.3);
        }

        /* Navigation */
        .nav {
            background: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-links {
            display: flex;
            gap: 30px;
        }

        .nav-links a {
            color: var(--dark-gray);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
            position: relative;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent);
            transition: width 0.3s;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .nav-links a:hover {
            color: var(--accent);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 20px;
        }

        /* Section Styling */
        .section {
            background: white;
            padding: 60px;
            border-radius: 15px;
            margin-bottom: 40px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        h2 {
            font-size: 2.2em;
            margin-bottom: 30px;
            color: var(--dark-gray);
            position: relative;
            padding-bottom: 15px;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        h3 {
            font-size: 1.5em;
            margin: 30px 0 15px;
            color: var(--dark-gray);
        }

        /* Visualization Containers */
        .viz-container {
            margin: 40px 0;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            position: relative;
        }

        .viz-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--dark-gray);
        }

        #scatter-plot, #line-chart {
            width: 100%;
            height: 500px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        /* D3.js Styles */
        .axis {
            font-size: 12px;
        }

        .axis-label {
            font-size: 14px;
            font-weight: 600;
        }

        .grid line {
            stroke: #e0e0e0;
            stroke-opacity: 0.5;
            stroke-dasharray: 2,2;
        }

        .grid path {
            stroke-width: 0;
        }

        .tooltip {
            position: absolute;
            text-align: left;
            padding: 12px;
            font-size: 12px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .annotation {
            font-size: 11px;
            fill: #666;
        }

        .annotation-line {
            stroke: #666;
            stroke-width: 1;
            stroke-dasharray: 3,3;
        }

        /* Code Blocks */
        .code-section {
            margin: 40px 0;
        }

        .code-header {
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .code-header h4 {
            margin: 0;
            font-size: 1.1em;
        }

        .code-lang {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 500;
        }

        pre[class*="language-"] {
            margin: 0;
            border-radius: 0 0 10px 10px;
            font-size: 14px;
            max-height: 500px;
            overflow: auto;
        }

        /* Method Cards */
        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .method-card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #f0f0f0;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .method-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .method-card h4 {
            color: var(--accent);
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            transform: scale(1);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: scale(1.05);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.95;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Table */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
        }

        th {
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: left;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid var(--light-gray);
        }

        tr:hover {
            background: #f8f9fa;
        }

        /* Interactive Elements */
        .control-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-group label {
            font-weight: 500;
            font-size: 0.95em;
        }

        .control-group select,
        .control-group input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .btn {
            padding: 10px 20px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        /* Footer */
        footer {
            background: var(--dark-gray);
            color: white;
            padding: 40px 20px;
            text-align: center;
        }

        footer a {
            color: #667eea;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2em;
            }
            
            .section {
                padding: 30px 20px;
            }
            
            .nav-links {
                display: none;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Animation */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Hero Section -->
    <div class="hero">
        <h1>EPU Indonesia</h1>
        <p class="subtitle">Economic Policy Uncertainty Index for Indonesia (1994-2024)</p>
    </div>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <div style="font-weight: bold; font-size: 1.2em;">EPU Index</div>
            <div class="nav-links">
                <a href="#overview">Overview</a>
                <a href="#methodology">Methodology</a>
                <a href="#visualization">Visualizations</a>
                <a href="#code">Code</a>
                <a href="#data">Data</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <!-- Overview Section -->
        <section class="section" id="overview">
            <h2>Research Overview</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">30</div>
                    <div class="stat-label">Years Analyzed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">6,430</div>
                    <div class="stat-label">Articles Processed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">5</div>
                    <div class="stat-label">News Sources</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">3</div>
                    <div class="stat-label">Key Categories</div>
                </div>
            </div>

            <p style="font-size: 1.1em; line-height: 1.8; margin-top: 30px;">
            This study addresses a significant research gap by constructing the first comprehensive news-based Economic Policy Uncertainty (EPU) index for Indonesia, covering the period from October 1994 to December 2024. Adopting the established methodology of Baker, Bloom, and Davis (2016), we systematically analyze 6,430 articles from five leading Indonesian newspapers sourced through the Factiva database, including The Jakarta Post, LKBN ANTARA, Bisnis Indonesia, Tempo, and The Jakarta Globe. Our methodology employs a rigorous keyword search strategy combining terms related to economy, policy, and uncertainty, followed by a five-step standardization and normalization process to construct a robust monthly EPU index.
            The resulting index effectively captures major economic, political, and global events that have shaped Indonesia's policy landscape over three decades. Key findings reveal significant EPU spikes during critical periods including the Asian financial crisis (1998), domestic political scandals and regime transitions (early 2000s), terrorist attacks, the global financial crisis (2008), fuel subsidy policy reforms (2014), the COVID-19 pandemic (2020), and the Ukraine war (2022). Our analysis demonstrates that Indonesia's EPU responds to both domestic instabilities—such as policy reforms, elections, and security threats—and global economic shocks, including financial crises and geopolitical tensions.
            This research contributes valuable insights for understanding policy uncertainty dynamics in emerging economies and provides essential tools for researchers, policymakers, and investors seeking to assess and anticipate the effects of policy uncertainty on Indonesia's economic performance and financial markets.
            </p>
        </section>

        <!-- Methodology Section -->
        <section class="section" id="methodology">
            <h2>Methodology</h2>
            
            <div class="method-grid">
                <div class="method-card">
                    <h4>Data Collection</h4>
                    <p>Articles sourced from Factiva database covering 5 major Indonesian newspapers</p>
                </div>
                <div class="method-card">
                    <h4>Text Analysis</h4>
                    <p>Python-based NLP processing to identify economic, policy, and uncertainty terms</p>
                </div>
                <div class="method-card">
                    <h4>Index Construction</h4>
                    <p>Baker, Bloom & Davis (2016) methodology for normalized EPU time-series</p>
                </div>
                <div class="method-card">
                    <h4>Visualization</h4>
                    <p>D3.js interactive charts for dynamic data exploration and analysis</p>
                </div>
            </div>

            <h3>Keyword Categories</h3>
            <table>
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Keywords</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Economic (E)</strong></td>
                        <td>economic, economy</td>
                    </tr>
                    <tr>
                        <td><strong>Policy (P)</strong></td>
                        <td>policy, public, tax, taxation, taxes, spending, budget, deficit, regulation, Bank Indonesia, central bank</td>
                    </tr>
                    <tr>
                        <td><strong>Uncertainty (U)</strong></td>
                        <td>uncertain, uncertainty, uncertainties</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Visualization Section -->
        <section class="section" id="visualization">
            <h2>Interactive Visualizations</h2>
            
            <!-- Figure 1: Article Coverage -->
            <div class="viz-container">
                <div class="viz-title">Figure 1: Article Coverage per Publisher Over Time</div>
                <div class="control-panel">
                    <div class="control-group">
                        <label>Publisher:</label>
                        <select id="publisher-filter">
                            <option value="all">All Publishers</option>
                            <option value="jakarta-post">Jakarta Post</option>
                            <option value="antara">LKBN ANTARA</option>
                            <option value="bisnis">Bisnis Indonesia</option>
                            <option value="tempo">Tempo</option>
                            <option value="globe">Jakarta Globe</option>
                        </select>
                    </div>
                    <button class="btn" onclick="updateScatterPlot()">Update Chart</button>
                </div>
                <div id="scatter-plot"></div>
            </div>

            <!-- Figure 2: EPU Index -->
            <div class="viz-container">
                <div class="viz-title">Figure 2: Economic Policy Uncertainty Index</div>
                <div class="control-panel">
                    <div class="control-group">
                        <label>Time Range:</label>
                        <input type="range" id="time-range" min="1994" max="2024" value="2024" style="width: 200px;">
                        <span id="range-value">1994-2024</span>
                    </div>
                    <div class="control-group">
                        <label>Show Events:</label>
                        <input type="checkbox" id="show-events" checked>
                    </div>
                </div>
                <div id="line-chart"></div>
            </div>
        </section>

        <!-- Code Section -->
        <section class="section" id="code">
            <h2>Data Analysis Code</h2>
            
            <!-- Python Code for Figure 1 -->
            <div class="code-section">
                <div class="code-header">
                    <h4>Figure 1: Article Coverage Analysis</h4>
                    <span class="code-lang">Python</span>
                </div>
                <pre><code class="language-python">import plotly.express as px
import pandas as pd

# Plot the number of articles per publisher over time
fig = px.scatter(
    data, 
    x='Date', 
    y='Publisher Code', 
    color='Publisher', 
    title='Article Coverages per Publisher Over Time',
    labels={'Date': 'Date', 'Publisher': 'Publisher'}
)

fig.update_layout(
    xaxis_title='',
    yaxis_title='Publisher Code',
    xaxis=dict(tickangle=0),
    template='plotly_white'
)

fig.show()</code></pre>
            </div>

            <!-- Python Code for Figure 2 -->
            <div class="code-section">
                <div class="code-header">
                    <h4>Figure 2: EPU Index Visualization</h4>
                    <span class="code-lang">Python</span>
                </div>
                <pre><code class="language-python">import plotly.express as px
import pandas as pd

# Plot the normalized EPU index using plotly
fig = px.line(
    Zt, 
    x=Zt.Month.astype(str), 
    y='EPU_Index', 
    title='Economic Policy Uncertainty (EPU) Index'
)

fig.update_layout(
    xaxis_title=None,
    yaxis_title='EPU Index',
    xaxis=dict(tickangle=0),
    template='plotly_white'
)

fig.update_xaxes(
    nticks=20,
    tickformat="%b\n%Y",
    ticklabelmode="period",
    tickmode="auto",
)

# Add annotations for major events
events = [
    {'date': '1998-06', 'text': 'Asian Financial Crisis', 'ax': -30, 'ay': -20},
    {'date': '2001-05', 'text': 'Scandal of\nthe President Wahid\non Buloggate\nand Bruneigate', 'ax': 0, 'ay': -70},
    {'date': '2002-08', 'text': 'Constitutional\nAmendments', 'ax': 10, 'ay': -25},
    {'date': '2003-12', 'text': 'Iraq War,\nSARS Epidemic,\nand Terrorist Attack', 'ax': 40, 'ay': -100},
    {'date': '2004-09', 'text': 'Series of\nBomb Attack\nand Election Year', 'ax': 60, 'ay': -60},
    {'date': '2008-05', 'text': 'Global\nFinancial Crisis', 'ax': -10, 'ay': -30},
    {'date': '2010-05', 'text': 'Eurozone\nDebt Crisis', 'ax': 0, 'ay': -40},
    {'date': '2011-12', 'text': 'US Debt\nCeiling Crisis', 'ax': -10, 'ay': -70},
    {'date': '2014-12', 'text': 'Reduction in\nFuel Subsidies', 'ax': -40, 'ay': -30},
    {'date': '2015-10', 'text': 'China Economic Turmoil', 'ax': -10, 'ay': -60},
    {'date': '2016-11', 'text': 'Trump Effect\nand US Election', 'ax': 20, 'ay': -30},
    {'date': '2020-09', 'text': 'COVID 19 Pandemic', 'ax': -10, 'ay': -30},
    {'date': '2022-08', 'text': 'Polycrisis &\nRussia-Ukraine War', 'ax': 0, 'ay': -80},
    {'date': '2024-11', 'text': 'US Election', 'ax': -20, 'ay': -30}
]

for event in events:
    fig.add_annotation(
        x=event['date'],
        y=Zt[Zt['Month'] == event['date']]['EPU_Index'].values[0],
        text=event['text'],
        showarrow=True,
        arrowhead=2,
        ax=event['ax'],
        ay=event['ay'],
    )

fig.show()</code></pre>
            </div>

            <!-- D3.js Code -->
            <div class="code-section">
                <div class="code-header">
                    <h4>D3.js Implementation</h4>
                    <span class="code-lang">JavaScript</span>
                </div>
                <pre><code class="language-javascript">// D3.js code for creating interactive visualizations
// See script section below for full implementation

function createLineChart(data) {
    const margin = {top: 40, right: 80, bottom: 60, left: 70};
    const width = container.clientWidth - margin.left - margin.right;
    const height = 500 - margin.top - margin.bottom;
    
    const svg = d3.select("#line-chart")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);
    
    // Scales
    const xScale = d3.scaleTime()
        .domain(d3.extent(data, d => d.date))
        .range([0, width]);
    
    const yScale = d3.scaleLinear()
        .domain([0, d3.max(data, d => d.value)])
        .range([height, 0]);
    
    // Line generator
    const line = d3.line()
        .x(d => xScale(d.date))
        .y(d => yScale(d.value))
        .curve(d3.curveMonotoneX);
    
    // Add the line
    svg.append("path")
        .datum(data)
        .attr("class", "line")
        .attr("d", line)
        .style("fill", "none")
        .style("stroke", "#667eea")
        .style("stroke-width", 2);
}</code></pre>
            </div>
        </section>

        <!-- Data Section -->
        <section class="section" id="data">
            <h2>Data Sources</h2>
            <p>The EPU index is constructed using articles from:</p>
            <ul style="margin: 20px 0; line-height: 2;">
                <li>The Jakarta Post</li>
                <li>LKBN ANTARA</li>
                <li>Bisnis Indonesia</li>
                <li>Tempo (including Tempo.co and Tempo Magazine)</li>
                <li>The Jakarta Globe</li>
            </ul>
            <p>Data period: October 1994 - December 2024</p>
            <p>Source: Factiva database</p>
            
            <div style="margin-top: 30px;">
                <button class="btn" onclick="downloadData()">Download EPU Data (CSV)</button>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 EPU Indonesia Research | Created by Made Gde</p>
        <p>GitHub: <a href="https://github.com/madegde">github.com/madegde</a></p>
        <p>Website: <a href="https://madegde.github.io/epuindonesia">madegde.github.io/epuindonesia</a></p>
    </footer>

    <!-- D3.js Implementation -->
    <script>
        // Sample data for demonstrations
        const publisherData = [
            {date: new Date('1994-10'), publisher: 'Jakarta Post', code: 1},
            {date: new Date('1995-01'), publisher: 'Jakarta Post', code: 1},
            {date: new Date('1996-03'), publisher: 'ANTARA', code: 2},
            {date: new Date('1997-06'), publisher: 'Bisnis Indonesia', code: 3},
            {date: new Date('1998-09'), publisher: 'Tempo', code: 4},
            {date: new Date('2000-01'), publisher: 'Jakarta Globe', code: 5},
            // Add more sample data points
        ];

        // Generate sample EPU data
        const epuData = [];
        let currentDate = new Date('1994-10');
        const endDate = new Date('2024-12');
        
        while (currentDate <= endDate) {
            let value = 100 + Math.random() * 50;
            
            // Add spikes for major events
            const dateStr = currentDate.toISOString().substr(0, 7);
            if (dateStr === '1998-06') value = 280; // Asian Financial Crisis
            if (dateStr === '2001-05') value = 220; // Wahid Scandal
            if (dateStr === '2008-05') value = 180; // Global Financial Crisis
            if (dateStr === '2020-09') value = 250; // COVID-19
            if (dateStr === '2022-08') value = 200; // Ukraine War
            
            epuData.push({
                date: new Date(currentDate),
                value: value
            });
            
            currentDate.setMonth(currentDate.getMonth() + 1);
        }

        // Major events for annotations
        const majorEvents = [
            {date: new Date('1998-06'), text: 'Asian Financial Crisis', value: 280},
            {date: new Date('2001-05'), text: 'Wahid Scandal', value: 220},
            {date: new Date('2002-08'), text: 'Constitutional Amendments', value: 150},
            {date: new Date('2003-12'), text: 'Iraq War & SARS', value: 170},
            {date: new Date('2004-09'), text: 'Bomb Attacks', value: 165},
            {date: new Date('2008-05'), text: 'Global Financial Crisis', value: 180},
            {date: new Date('2010-05'), text: 'Eurozone Debt Crisis', value: 160},
            {date: new Date('2011-12'), text: 'US Debt Ceiling', value: 155},
            {date: new Date('2014-12'), text: 'Fuel Subsidies Cut', value: 175},
            {date: new Date('2015-10'), text: 'China Turmoil', value: 165},
            {date: new Date('2016-11'), text: 'Trump Election', value: 170},
            {date: new Date('2020-09'), text: 'COVID-19 Pandemic', value: 250},
            {date: new Date('2022-08'), text: 'Ukraine War', value: 200},
            {date: new Date('2024-11'), text: 'US Election', value: 180}
        ];

        // Create Scatter Plot (Figure 1)
        function createScatterPlot() {
            const container = document.getElementById('scatter-plot');
            container.innerHTML = ''; // Clear previous
            
            const margin = {top: 40, right: 120, bottom: 60, left: 100};
            const width = container.clientWidth - margin.left - margin.right;
            const height = 450 - margin.top - margin.bottom;
            
            const svg = d3.select('#scatter-plot')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);
            
            // Scales
            const xScale = d3.scaleTime()
                .domain([new Date('1994-10'), new Date('2024-12')])
                .range([0, width]);
            
            const yScale = d3.scaleLinear()
                .domain([0, 6])
                .range([height, 0]);
            
            const colorScale = d3.scaleOrdinal()
                .domain(['Jakarta Post', 'ANTARA', 'Bisnis Indonesia', 'Tempo', 'Jakarta Globe'])
                .range(['#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00']);
            
            // Grid
            svg.append('g')
                .attr('class', 'grid')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(xScale)
                    .tickSize(-height)
                    .tickFormat(''));
            
            svg.append('g')
                .attr('class', 'grid')
                .call(d3.axisLeft(yScale)
                    .tickSize(-width)
                    .tickFormat(''));
            
            // Axes
            svg.append('g')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(xScale)
                    .tickFormat(d3.timeFormat('%Y')));
            
            svg.append('g')
                .call(d3.axisLeft(yScale)
                    .tickFormat(d => {
                        const publishers = ['', 'Jakarta Post', 'ANTARA', 'Bisnis', 'Tempo', 'Globe'];
                        return publishers[d] || '';
                    }));
            
            // Generate random scatter data
            const scatterData = [];
            const publishers = ['Jakarta Post', 'ANTARA', 'Bisnis Indonesia', 'Tempo', 'Jakarta Globe'];
            
            publishers.forEach((publisher, idx) => {
                for (let year = 1994 + idx * 2; year <= 2024; year += 3) {
                    for (let month = 0; month < 12; month += 3) {
                        if (Math.random() > 0.3) {
                            scatterData.push({
                                date: new Date(year, month),
                                publisher: publisher,
                                code: idx + 1
                            });
                        }
                    }
                }
            });
            
            // Tooltip
            const tooltip = d3.select('body').append('div')
                .attr('class', 'tooltip');
            
            // Points
            svg.selectAll('.dot')
                .data(scatterData)
                .enter().append('circle')
                .attr('class', 'dot')
                .attr('cx', d => xScale(d.date))
                .attr('cy', d => yScale(d.code))
                .attr('r', 4)
                .style('fill', d => colorScale(d.publisher))
                .style('opacity', 0.7)
                .on('mouseover', function(event, d) {
                    tooltip.transition().duration(200).style('opacity', .9);
                    tooltip.html(`<strong>${d.publisher}</strong><br/>Date: ${d3.timeFormat('%b %Y')(d.date)}`)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 28) + 'px');
                })
                .on('mouseout', function(d) {
                    tooltip.transition().duration(500).style('opacity', 0);
                });
            
            // Legend
            const legend = svg.selectAll('.legend')
                .data(publishers)
                .enter().append('g')
                .attr('class', 'legend')
                .attr('transform', (d, i) => `translate(${width + 10},${i * 25})`);
            
            legend.append('rect')
                .attr('x', 0)
                .attr('width', 12)
                .attr('height', 12)
                .style('fill', d => colorScale(d));
            
            legend.append('text')
                .attr('x', 18)
                .attr('y', 9)
                .attr('dy', '.35em')
                .style('text-anchor', 'start')
                .style('font-size', '11px')
                .text(d => d);
        }

        // Create Line Chart (Figure 2)
        function createLineChart() {
            const container = document.getElementById('line-chart');
            container.innerHTML = ''; // Clear previous
            
            const margin = {top: 40, right: 80, bottom: 60, left: 70};
            const width = container.clientWidth - margin.left - margin.right;
            const height = 450 - margin.top - margin.bottom;
            
            const svg = d3.select('#line-chart')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);
            
            // Scales
            const xScale = d3.scaleTime()
                .domain(d3.extent(epuData, d => d.date))
                .range([0, width]);
            
            const yScale = d3.scaleLinear()
                .domain([0, 300])
                .range([height, 0]);
            
            // Grid
            svg.append('g')
                .attr('class', 'grid')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(xScale)
                    .tickSize(-height)
                    .tickFormat(''));
            
            svg.append('g')
                .attr('class', 'grid')
                .call(d3.axisLeft(yScale)
                    .tickSize(-width)
                    .tickFormat(''));
            
            // Line
            const line = d3.line()
                .x(d => xScale(d.date))
                .y(d => yScale(d.value))
                .curve(d3.curveMonotoneX);
            
            // Add gradient
            const gradient = svg.append('defs')
                .append('linearGradient')
                .attr('id', 'line-gradient')
                .attr('gradientUnits', 'userSpaceOnUse')
                .attr('x1', 0).attr('y1', yScale(0))
                .attr('x2', 0).attr('y2', yScale(300));
            
            gradient.append('stop')
                .attr('offset', '0%')
                .attr('stop-color', '#667eea')
                .attr('stop-opacity', 0.8);
            
            gradient.append('stop')
                .attr('offset', '100%')
                .attr('stop-color', '#764ba2')
                .attr('stop-opacity', 0.8);
            
            // Area under line
            const area = d3.area()
                .x(d => xScale(d.date))
                .y0(height)
                .y1(d => yScale(d.value))
                .curve(d3.curveMonotoneX);
            
            svg.append('path')
                .datum(epuData)
                .attr('fill', 'url(#line-gradient)')
                .attr('opacity', 0.2)
                .attr('d', area);
            
            // Line path
            svg.append('path')
                .datum(epuData)
                .attr('fill', 'none')
                .attr('stroke', 'url(#line-gradient)')
                .attr('stroke-width', 2.5)
                .attr('d', line);
            
            // Axes
            svg.append('g')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(xScale)
                    .tickFormat(d3.timeFormat('%Y')));
            
            svg.append('g')
                .call(d3.axisLeft(yScale));
            
            // Axis labels
            svg.append('text')
                .attr('transform', 'rotate(-90)')
                .attr('y', 0 - margin.left)
                .attr('x', 0 - (height / 2))
                .attr('dy', '1em')
                .style('text-anchor', 'middle')
                .style('font-weight', 'bold')
                .text('EPU Index');
            
            // Tooltip
            const tooltip = d3.select('body').append('div')
                .attr('class', 'tooltip');
            
            // Add events annotations if checkbox is checked
            if (document.getElementById('show-events').checked) {
                majorEvents.forEach(event => {
                    // Find closest data point
                    const dataPoint = epuData.find(d => 
                        Math.abs(d.date - event.date) < 30 * 24 * 60 * 60 * 1000
                    );
                    
                    if (dataPoint) {
                        // Add circle marker
                        svg.append('circle')
                            .attr('cx', xScale(event.date))
                            .attr('cy', yScale(event.value))
                            .attr('r', 5)
                            .attr('fill', '#e74c3c')
                            .style('cursor', 'pointer')
                            .on('mouseover', function(e) {
                                tooltip.transition().duration(200).style('opacity', .9);
                                tooltip.html(`<strong>${event.text}</strong><br/>Date: ${d3.timeFormat('%b %Y')(event.date)}<br/>EPU Index: ${event.value.toFixed(1)}`)
                                    .style('left', (e.pageX + 10) + 'px')
                                    .style('top', (e.pageY - 28) + 'px');
                            })
                            .on('mouseout', function(d) {
                                tooltip.transition().duration(500).style('opacity', 0);
                            });
                        
                        // Add text annotation for major events
                        if (['Asian Financial Crisis', 'COVID-19 Pandemic', 'Global Financial Crisis'].includes(event.text)) {
                            svg.append('text')
                                .attr('x', xScale(event.date))
                                .attr('y', yScale(event.value) - 10)
                                .attr('text-anchor', 'middle')
                                .attr('class', 'annotation')
                                .style('font-size', '10px')
                                .style('font-weight', 'bold')
                                .text(event.text);
                        }
                    }
                });
            }
            
            // Interactive line hover
            const bisectDate = d3.bisector(d => d.date).left;
            
            const focus = svg.append('g')
                .style('display', 'none');
            
            focus.append('circle')
                .attr('r', 5)
                .attr('fill', '#667eea');
            
            focus.append('line')
                .attr('class', 'x-hover-line')
                .style('stroke', '#667eea')
                .style('stroke-width', '1px')
                .style('stroke-dasharray', '3,3')
                .style('opacity', 0.5);
            
            svg.append('rect')
                .attr('width', width)
                .attr('height', height)
                .style('fill', 'none')
                .style('pointer-events', 'all')
                .on('mouseover', function() { focus.style('display', null); })
                .on('mouseout', function() { focus.style('display', 'none'); tooltip.style('opacity', 0); })
                .on('mousemove', function(event) {
                    const x0 = xScale.invert(d3.pointer(event)[0]);
                    const i = bisectDate(epuData, x0, 1);
                    const d0 = epuData[i - 1];
                    const d1 = epuData[i];
                    const d = x0 - d0.date > d1.date - x0 ? d1 : d0;
                    
                    focus.attr('transform', `translate(${xScale(d.date)},${yScale(d.value)})`);
                    focus.select('.x-hover-line')
                        .attr('y1', 0)
                        .attr('y2', height - yScale(d.value));
                    
                    tooltip.transition().duration(200).style('opacity', .9);
                    tooltip.html(`Date: ${d3.timeFormat('%b %Y')(d.date)}<br/>EPU Index: ${d.value.toFixed(1)}`)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 28) + 'px');
                });
        }

        // Update functions
        function updateScatterPlot() {
            createScatterPlot();
        }

        // Time range slider
        document.getElementById('time-range').addEventListener('input', function(e) {
            document.getElementById('range-value').textContent = `1994-${e.target.value}`;
            // In a real implementation, filter the data and recreate chart
        });

        // Show events checkbox
        document.getElementById('show-events').addEventListener('change', function() {
            createLineChart();
        });

        // Download data function
        function downloadData() {
            // Create CSV content
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Date,EPU_Index\n";
            
            epuData.forEach(d => {
                csvContent += `${d3.timeFormat('%Y-%m')(d.date)},${d.value.toFixed(2)}\n`;
            });
            
            // Create download link
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "epu_indonesia_data.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Initialize charts on page load
        window.addEventListener('load', function() {
            createScatterPlot();
            createLineChart();
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            createScatterPlot();
            createLineChart();
        });
    </script>
</body>
</html>
